---
output:
  html_document:
    keep_md: yes
  word_document: default
  pdf_document: default
---

Simulated Exponential Means and the Central Limit Theorem
=====================================================================================================


# Overview:

In the below project I investigate simulations of the exponential distribution and compare it with the Central Limit Theorem. My aim is to compare the theoretical mean and variance with the simulated mean and variance and to show that the distribution is approximately normal.


## Simulations: 

```{r message=FALSE}
##Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
```

A simulation is run where 40 random exponentials are generated. The mean of the exponentials is then taken. This is repeated a thousand times to form a distribution of these means. Lambda is set as 0.2.

```{r}
#set seed and define parameters
set.seed(111)
lambda <- 0.2
n <- 40
sims <- 1000

##run simulation
runsim <- replicate(sims, rexp(n,lambda)) %>% 
        t() %>% as_tibble

##add per-sim mean of exponentials
runsim <- runsim %>% mutate(rmean = rowMeans(runsim))
```


## Sample Mean versus Theoretical Mean: 

Firstly, calculate the mean of the simulated distrubution then compare this to the theoretical mean.

```{r}
##mean of the simulated distrubution
sim_mean <- mean(runsim$rmean)

##theoretical mean
act_mean <- 1/lambda

sim_mean
act_mean
```

The proximity of these can be plotted on the distribution generated by the means of the simulations. Light green shows the theoretical mean of the distribution, light red shows the simulated mean of the distribution. They are remarkably close. (code chunk 1 in appendix)

```{r echo=FALSE}
g2 <- ggplot(runsim, aes(runsim$rmean)) +
        geom_histogram(aes(y=..density..), binwidth = 0.1, color="black", fill="#84a7e0") + 
        xlab("Simulation Mean") + 
        ylab("Frequency") + 
        ggtitle("Distribution of Simulated Exponential Means") +
        geom_vline(xintercept = sim_mean, color = "red", size = 1) +
        geom_vline(xintercept = act_mean, color = "green", size = 1) +
        theme_bw()
print(g2)
```


## Sample Variance versus Theoretical Variance: 

Next, we calculate the variance of the simulated distrubution then compare this to the theoretical variance. Again, these are very similar.

```{r}
##simulated variance
sim_sd <- sd(runsim$rmean)
sim_var <- sim_sd^2

##theoretical variance
act_sd <- (1/lambda)/sqrt(n)
act_var <- act_sd^2

sim_var
act_var
```


## Distribution: 

By plotting the distribution density against a standard normal distribution it is possible to estimate how closely these match and, therefore, how close to normal the distribution comes. The below figure shows that the distribution is very close to normal.

The dark red line represents the density of the distrubition, the dark green line represents a standard normal distribution. (code chunk 2 in appendix)

```{r echo=FALSE}
g3 <- ggplot(runsim, aes(runsim$rmean)) +
        geom_histogram(aes(y=..density..), binwidth = 0.1, color="black", fill="#84a7e0") + 
        geom_density(aes(y=..density..), colour = "darkred", size = 1) +
        xlab("Simulation Mean") + 
        ylab("Frequency") + 
        ggtitle("Distribution of Simulated Exponential Means") +
        stat_function(fun = dnorm, args = list(mean = sim_mean, sd = sim_sd), colour = "darkgreen", size = 1) + 
        theme_bw()
print(g3)
```

In conclusion: The distribution of simulated exponential means does generally behave as expected by the Central Limit Theorem.

##Appendix

* Code chunk 1
```{r}
g2 <- ggplot(runsim, aes(runsim$rmean)) +
        geom_histogram(aes(y=..density..), binwidth = 0.1, color="black", fill="#84a7e0") + 
        xlab("Simulation Mean") + 
        ylab("Frequency") + 
        ggtitle("Distribution of Simulated Exponential Means") +
        geom_vline(xintercept = sim_mean, color = "red", size = 1) +
        geom_vline(xintercept = act_mean, color = "green", size = 1) +
        theme_bw()
```

* Code chunk 2
```{r}
g3 <- ggplot(runsim, aes(runsim$rmean)) +
        geom_histogram(aes(y=..density..), binwidth = 0.1, color="black", fill="#84a7e0") + 
        geom_density(aes(y=..density..), colour = "darkred", size = 1) +
        xlab("Simulation Mean") + 
        ylab("Frequency") + 
        ggtitle("Distribution of Simulated Exponential Means") +
        stat_function(fun = dnorm, args = list(mean = sim_mean, sd = sim_sd), colour = "darkgreen", size = 1) + 
        theme_bw()
```

